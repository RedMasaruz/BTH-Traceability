# ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Code.gs (Google Apps Script Backend)

## üìã ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°

Code.gs ‡∏Ñ‡∏∑‡∏≠ backend ‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ö‡∏ô Google Apps Script ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Google Sheets ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

---

## üöÄ ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Code.gs

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° Google Sheets

#### 1.1 ‡∏™‡∏£‡πâ‡∏≤‡∏á Spreadsheet ‡∏´‡∏•‡∏±‡∏Å (SheetA + Users)

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà [Google Sheets](https://sheets.google.com)
2. ‡∏Ñ‡∏•‡∏¥‡∏Å **"Blank"** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏µ‡∏ï‡πÉ‡∏´‡∏°‡πà
3. ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠: `BTH Farmer Data - Main`
4. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å **Spreadsheet ID** ‡∏à‡∏≤‡∏Å URL:
   ```
   https://docs.google.com/spreadsheets/d/14GPDajc6BmrAzge-kWf5gkffSjnoHhlqApg-5ApKdKc/edit
                                          ‚Üë
                                  ‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠ Spreadsheet ID
   ```

5. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏µ‡∏ï **"SheetA"** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£:
   - Header row (‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà 1):
   ```
   ‡πÄ‡∏ß‡∏•‡∏≤ | ‡∏•‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î | ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• | ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ | ‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£ | ‡∏ï‡∏≥‡∏ö‡∏• | ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ | ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î | ...
   ```

6. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏µ‡∏ï **"Users"** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:
   - Header row:
   ```
   username | password | long_name | role
   ```
   - ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:
   ```
   admin | your_password | ‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö | admin
   user1 | pass123 | ‡∏•‡πâ‡∏á‡∏û‡∏µ‡πà‡∏ö‡∏≤‡∏™ | user
   ```

7. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏µ‡∏ï **"UserAdmin"** (optional - ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö admin):
   - Header row:
   ```
   username | password | long_name | email | role | created_at
   ```

8. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏µ‡∏ï **"AuditLog"** (optional - ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô):
   - Header row:
   ```
   ‡πÄ‡∏ß‡∏•‡∏≤ | action | username | details | ip
   ```

#### 1.2 ‡∏™‡∏£‡πâ‡∏≤‡∏á Spreadsheet ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ (SheetB)

1. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏µ‡∏ï‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏≠‡∏±‡∏ô
2. ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠: `BTH Farmer Data - Usage`
3. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å **Spreadsheet ID**
4. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏µ‡∏ï‡∏ï‡∏≤‡∏°‡∏ä‡∏∑‡πà‡∏≠‡∏•‡πâ‡∏á‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÄ‡∏ä‡πà‡∏ô:
   - `‡∏•‡πâ‡∏á‡∏û‡∏µ‡πà‡∏ö‡∏≤‡∏™BDS`
   - `‡∏•‡πâ‡∏á‡∏û‡∏µ‡πàHunter‡πÄ‡∏ß‡∏µ‡∏¢‡∏á‡πÅ‡∏Å‡πà‡∏ô`
   - ‡∏Ø‡∏•‡∏Ø (‡∏ï‡∏≤‡∏° SHEET_B_NAMES ‡πÉ‡∏ô Code.gs)

#### 1.3 ‡∏™‡∏£‡πâ‡∏≤‡∏á Spreadsheet ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à

1. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏µ‡∏ï‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏≠‡∏±‡∏ô
2. ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠: `BTH Survey Data`
3. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å **Spreadsheet ID**
4. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏µ‡∏ï: `‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å‡∏û‡∏∑‡∏ä‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡πà‡∏≠‡∏°`

---

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏™‡∏£‡πâ‡∏≤‡∏á Google Apps Script Project

#### 2.1 ‡∏™‡∏£‡πâ‡∏≤‡∏á Script Project

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà [Google Apps Script](https://script.google.com)
2. ‡∏Ñ‡∏•‡∏¥‡∏Å **"New project"**
3. ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ: `BTH Farmer System`

#### 2.2 ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î Code.gs

1. ‡πÉ‡∏ô Script Editor ‡πÉ‡∏´‡πâ‡∏•‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
2. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏à‡∏≤‡∏Å `Code.gs` ‡πÉ‡∏ô‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡∏ô‡∏µ‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
3. ‡∏ß‡∏≤‡∏á‡πÉ‡∏ô Script Editor
4. ‡∏Ñ‡∏•‡∏¥‡∏Å **Save** (üíæ)

#### 2.3 ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î index.html

1. ‡∏Ñ‡∏•‡∏¥‡∏Å **+** ‡∏Ç‡πâ‡∏≤‡∏á Files
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **HTML**
3. ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠: `index` (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏™‡πà .html)
4. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏à‡∏≤‡∏Å `index.html` ‡πÉ‡∏ô‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡∏ô‡∏µ‡πâ
5. ‡∏ß‡∏≤‡∏á‡πÅ‡∏•‡∏∞ Save

---

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Spreadsheet IDs

‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á Code.gs:

```javascript
/* ========== CONFIG ========== */
const SPREADSHEET_ID_A = 'YOUR_MAIN_SPREADSHEET_ID_HERE';
const SPREADSHEET_ID_B = 'YOUR_USAGE_SPREADSHEET_ID_HERE';
const SURVEY_SPREADSHEET_ID = 'YOUR_SURVEY_SPREADSHEET_ID_HERE';
```

**‡∏ß‡∏¥‡∏ò‡∏µ‡∏´‡∏≤ Spreadsheet ID:**
```
URL: https://docs.google.com/spreadsheets/d/14GPDajc6BmrAzge-kWf5gkffSjnoHhlqApg-5ApKdKc/edit
                                          ‚Üë
                                  Spreadsheet ID (‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ)
```

---

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 4: ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Slides Template (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö PDF Preview)

#### 4.1 ‡∏™‡∏£‡πâ‡∏≤‡∏á Slides Template

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà [Google Slides](https://slides.google.com)
2. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏á‡∏≤‡∏ô‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠‡πÉ‡∏´‡∏°‡πà
3. ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö template ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£
4. ‡πÉ‡∏™‡πà placeholder ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ ‡πÄ‡∏ä‡πà‡∏ô:
   ```
   {{farmer_name_main}}
   {{tel}}
   {{coord_x}}, {{coord_y}}
   {{tree_count}}
   ```
5. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å **Presentation ID** ‡∏à‡∏≤‡∏Å URL:
   ```
   https://docs.google.com/presentation/d/1NP9r9IfD5Zedc1lSKN0VNuPCfKz2_LmK_unmM1ayKyw/edit
                                           ‚Üë
                                   Presentation ID
   ```

#### 4.2 ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó Slide Template ID ‡πÉ‡∏ô Code.gs

```javascript
const SLIDE_TEMPLATE_ID = "YOUR_SLIDE_TEMPLATE_ID_HERE";
```

#### 4.3 ‡∏™‡∏£‡πâ‡∏≤‡∏á Folder ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö PDF

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà [Google Drive](https://drive.google.com)
2. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà: `BTH Survey PDFs`
3. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å **Folder ID** ‡∏à‡∏≤‡∏Å URL:
   ```
   https://drive.google.com/drive/folders/1f-aL2Ychh2QaKzJdstr-WrvpaofnaGeP
                                           ‚Üë
                                      Folder ID
   ```

#### 4.4 ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó Folder ID ‡πÉ‡∏ô Code.gs

```javascript
const PDF_FOLDER_ID = "YOUR_FOLDER_ID_HERE";
```

---

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 5: ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Permissions (‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå)

#### 5.1 ‡πÉ‡∏´‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå Script ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á Sheets

1. ‡πÉ‡∏ô Apps Script Editor ‡∏Ñ‡∏•‡∏¥‡∏Å **"Run"** (‚ñ∂Ô∏è)
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `doGet`
3. ‡∏Ñ‡∏•‡∏¥‡∏Å **"Run"**
4. ‡∏à‡∏∞‡∏°‡∏µ popup ‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï:
   - ‡∏Ñ‡∏•‡∏¥‡∏Å **"Review permissions"**
   - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ö‡∏±‡∏ç‡∏ä‡∏µ Google ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
   - ‡∏Ñ‡∏•‡∏¥‡∏Å **"Advanced"** ‚Üí **"Go to BTH Farmer System (unsafe)"**
   - ‡∏Ñ‡∏•‡∏¥‡∏Å **"Allow"**

#### 5.2 ‡πÅ‡∏ä‡∏£‡πå Spreadsheets

‡πÅ‡∏ä‡∏£‡πå‡∏ó‡∏∏‡∏Å Spreadsheet ‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ô Script:

1. ‡πÄ‡∏õ‡∏¥‡∏î Spreadsheet
2. ‡∏Ñ‡∏•‡∏¥‡∏Å **"Share"**
3. ‡πÉ‡∏™‡πà‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏Ç‡∏≠‡∏á Apps Script)
4. ‡πÉ‡∏´‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå: **"Editor"**
5. ‡∏Ñ‡∏•‡∏¥‡∏Å **"Send"**

---

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 6: Deploy ‡πÄ‡∏õ‡πá‡∏ô Web App

#### 6.1 Deploy

1. ‡πÉ‡∏ô Apps Script Editor ‡∏Ñ‡∏•‡∏¥‡∏Å **"Deploy"** ‚Üí **"New deployment"**
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å type: **"Web app"**
3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤:
   - **Description:** `Production v1`
   - **Execute as:** `Me (your@email.com)`
   - **Who has access:** `Anyone` ‡∏´‡∏£‡∏∑‡∏≠ `Anyone with the link`
4. ‡∏Ñ‡∏•‡∏¥‡∏Å **"Deploy"**

#### 6.2 ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Web App URL

‡∏à‡∏∞‡πÑ‡∏î‡πâ URL ‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ:
```
https://script.google.com/macros/s/AKfycbxxx.../exec
```

**‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠ URL ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏£‡∏∞‡∏ö‡∏ö!** üéâ

---

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 7: ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö

#### 7.1 ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏õ‡∏¥‡∏î Web App

1. ‡πÄ‡∏õ‡∏¥‡∏î URL ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å Deploy
2. ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Login
3. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Login ‡∏î‡πâ‡∏ß‡∏¢ username/password ‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ‡πÉ‡∏ô Users sheet

#### 7.2 ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡πà‡∏≤‡∏á‡πÜ

```javascript
// ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÉ‡∏ô Apps Script Editor
function testSheetAccess() {
  Logger.log(testSheetAccess());
}

function testUserLogin() {
  const result = userLogin('admin', 'your_password');
  Logger.log(result);
}
```

---

## üîß Configuration Checklist

‡∏Å‡πà‡∏≠‡∏ô Deploy ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏£‡∏ö:

- [ ] **SPREADSHEET_ID_A** - Spreadsheet ‡∏´‡∏•‡∏±‡∏Å (SheetA, Users, AuditLog)
- [ ] **SPREADSHEET_ID_B** - Spreadsheet ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (per ‡∏•‡πâ‡∏á)
- [ ] **SURVEY_SPREADSHEET_ID** - Spreadsheet ‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à
- [ ] **SLIDE_TEMPLATE_ID** - Slides template ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö PDF
- [ ] **PDF_FOLDER_ID** - Folder ‡πÄ‡∏Å‡πá‡∏ö PDF
- [ ] **SHEET_B_NAMES** - ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏•‡πâ‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ä‡∏µ‡∏ï‡πÉ‡∏ô Spreadsheet B)
- [ ] **Permissions** - ‡πÅ‡∏ä‡∏£‡πå‡∏ó‡∏∏‡∏Å Spreadsheet ‡∏Å‡∏±‡∏ö Script
- [ ] **Users sheet** - ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• username/password ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 user

---

## üîê ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ (Security)

### 1. ‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á

```javascript
// ‡πÉ‡∏ô Users sheet
username: admin
password: Strong@Pass123!  // ‡πÉ‡∏ä‡πâ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢
```

### 2. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ SECRET_KEY (optional)

```javascript
// ‡πÉ‡∏ô Apps Script Editor
// File ‚Üí Project properties ‚Üí Script properties
// ‡πÄ‡∏û‡∏¥‡πà‡∏° property:
// Key: SECRET_KEY
// Value: your-random-secret-key-here
```

‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô:
```javascript
function setupSecretKey() {
  const newKey = generateSecureSecretKey();
  PropertiesService.getScriptProperties().setProperty('SECRET_KEY', newKey);
  Logger.log('Secret key set!');
}
```

### 3. ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á

Deploy options:
- **Execute as:** `Me` (‡πÉ‡∏ä‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì)
- **Who has access:** 
  - `Only myself` - ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡∏∏‡∏ì
  - `Anyone within [organization]` - ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£
  - `Anyone` - ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô (‡∏£‡∏∞‡∏ß‡∏±‡∏á!)

---

## üîÑ ‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó Code

### ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏Ñ‡πâ‡∏î:

1. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ô Apps Script Editor
2. **Save** (üíæ)
3. **Deploy** ‚Üí **Manage deployments**
4. ‡∏Ñ‡∏•‡∏¥‡∏Å **‚úèÔ∏è Edit** ‡∏ó‡∏µ‡πà deployment ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
5. ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô **Version:** ‡πÄ‡∏õ‡πá‡∏ô `New version`
6. ‡πÉ‡∏™‡πà **Description** ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á
7. ‡∏Ñ‡∏•‡∏¥‡∏Å **"Deploy"**

**URL ‡πÄ‡∏î‡∏¥‡∏°‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏ï‡πà‡∏≠** (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô URL)

---

## üêõ ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: "Authorization required"

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Apps Script Editor
2. Run ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏î‡∏Å‡πá‡πÑ‡∏î‡πâ (‡πÄ‡∏ä‡πà‡∏ô `doGet`)
3. ‡πÉ‡∏´‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ï‡∏≤‡∏°‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏≤‡∏Å‡∏è

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: "Spreadsheet not found"

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Spreadsheet ID ‡∏ß‡πà‡∏≤‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏î‡πâ‡πÅ‡∏ä‡∏£‡πå Spreadsheet ‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö Script ‡πÅ‡∏•‡πâ‡∏ß
3. ‡∏•‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î Spreadsheet ‡∏î‡πâ‡∏ß‡∏¢ URL:
   ```
   https://docs.google.com/spreadsheets/d/YOUR_SPREADSHEET_ID/edit
   ```

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: "Sheet not found"

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏µ‡∏ï‡∏ß‡πà‡∏≤‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö Code.gs ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà:
   - `SheetA`
   - `Users`
   - `UserAdmin`
   - ‡∏ä‡∏∑‡πà‡∏≠‡∏•‡πâ‡∏á‡∏ï‡πà‡∏≤‡∏á‡πÜ (‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö SHEET_B_NAMES)

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤ (Blank page)

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ deploy ‡πÅ‡∏ö‡∏ö "Web app"
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå `index.html` ‡πÉ‡∏ô Apps Script
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö console ‡∏î‡∏π error (F12)

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Login ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Users sheet ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• username/password
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ä‡∏∑‡πà‡∏≠ column ‡∏ß‡πà‡∏≤‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á:
   - `username`
   - `password`
   - `long_name`
   - `role`
3. ‡∏•‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏Å `userLogin()` ‡πÉ‡∏ô Apps Script Editor ‡∏î‡∏π‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå

---

## üìä ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

### Spreadsheet A (Main)

**SheetA:**
```
‡πÄ‡∏ß‡∏•‡∏≤ | ‡∏•‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î | ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• | ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ | ‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£ | ‡∏ï‡∏≥‡∏ö‡∏• | ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ | ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î | ...
```

**Users:**
```
username | password | long_name | role
admin    | pass123  | ‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•    | admin
user1    | user123  | ‡∏•‡πâ‡∏á‡∏û‡∏µ‡πà‡∏ö‡∏≤‡∏™  | user
```

**UserAdmin (optional):**
```
username | password | long_name | email | role | created_at
```

**AuditLog (optional):**
```
‡πÄ‡∏ß‡∏•‡∏≤ | action | username | details | ip
```

### Spreadsheet B (Usage - per ‡∏•‡πâ‡∏á)

‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡∏µ‡∏ï (‡∏ï‡∏≤‡∏°‡∏ä‡∏∑‡πà‡∏≠‡∏•‡πâ‡∏á):
```
‡πÄ‡∏ß‡∏•‡∏≤ | ‡∏•‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î | ‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£ | ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• | ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ | ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πã‡∏¢ | ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ô‡∏≤‡πÇ‡∏ô | ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÅ‡∏£‡πà | ...
```

### Survey Spreadsheet

**‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å‡∏û‡∏∑‡∏ä‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡πà‡∏≠‡∏°:**
```
‡πÄ‡∏ß‡∏•‡∏≤ | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô | ‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô | ‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á | ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• | ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£ | ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ | ...
```

---

## üéØ Quick Start (TL;DR)

**‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ô‡∏£‡∏µ‡∏ö:**

1. **‡∏™‡∏£‡πâ‡∏≤‡∏á 3 Spreadsheets:**
   - Main (SheetA + Users)
   - Usage (‡∏ä‡∏µ‡∏ï‡∏ï‡∏≤‡∏°‡∏•‡πâ‡∏á)
   - Survey

2. **‡∏™‡∏£‡πâ‡∏≤‡∏á Apps Script Project:**
   - ‡∏ß‡∏≤‡∏á Code.gs
   - ‡∏ß‡∏≤‡∏á index.html

3. **‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ IDs ‡πÉ‡∏ô Code.gs:**
   - SPREADSHEET_ID_A
   - SPREADSHEET_ID_B
   - SURVEY_SPREADSHEET_ID

4. **‡πÉ‡∏´‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå:**
   - Run ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏î‡∏Å‡πá‡πÑ‡∏î‡πâ
   - Authorize

5. **Deploy:**
   - Deploy ‚Üí New deployment ‚Üí Web app
   - Copy URL

6. **‡πÄ‡∏™‡∏£‡πá‡∏à!** üéâ

---

## üìö ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á

- [Google Apps Script Documentation](https://developers.google.com/apps-script)
- [Spreadsheet Service](https://developers.google.com/apps-script/reference/spreadsheet)
- [HTML Service](https://developers.google.com/apps-script/guides/html)
- [Web Apps](https://developers.google.com/apps-script/guides/web)

---

## üÜò ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠?

**‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏ö‡πâ‡∏≤‡∏ô‡πÑ‡∏ó‡∏¢‡πÄ‡∏Æ‡∏¥‡∏£‡πå‡∏ö‡πÄ‡∏ã‡πá‡∏ô‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡∏à‡∏≥‡∏Å‡∏±‡∏î**
- üì± LINE: [@bthcenter](https://line.me/ti/p/LV4OFl3dcU)
- ‚òéÔ∏è Phone: 092-4579929, 063-5033042

---

## üéâ ‡∏™‡∏£‡∏∏‡∏õ

‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ó‡∏≥‡∏ï‡∏≤‡∏°‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡πÑ‡∏î‡πâ:

‚úÖ Google Apps Script Backend ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ  
‚úÖ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Google Sheets  
‚úÖ Web App URL ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏£‡∏∞‡∏ö‡∏ö  
‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö Login ‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£  

**‡πÅ‡∏•‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ö PWA ‚Üí ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡πÅ‡∏≠‡∏õ‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏î‡πâ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå!** üöÄ
